name: CI

on:
 pull_request:
  branches:
   - '**'

jobs:
 lint-and-typecheck:
  name: Lint and Type Check
  runs-on: ubuntu-latest

  steps:
   - name: Checkout code
     uses: actions/checkout@v4

   - name: Setup Node.js
     uses: actions/setup-node@v4
     with:
      node-version: '18'
      cache: 'npm'

   - name: Install dependencies
     run: npm ci

   - name: Run ESLint
     run: npm run lint

   - name: Run TypeScript type check
     run: npm run typecheck

 test:
  name: Run Tests
  runs-on: ubuntu-latest

  steps:
   - name: Checkout code
     uses: actions/checkout@v4

   - name: Setup Node.js
     uses: actions/setup-node@v4
     with:
      node-version: '18'
      cache: 'npm'

   - name: Install dependencies
     run: npm ci

   - name: Run tests
     run: npm test

 build:
  name: Build
  runs-on: ubuntu-latest
  needs: [lint-and-typecheck, test]

  steps:
   - name: Checkout code
     uses: actions/checkout@v4

   - name: Setup Node.js
     uses: actions/setup-node@v4
     with:
      node-version: '18'
      cache: 'npm'

   - name: Install dependencies
     run: npm ci

   - name: Build project
     run: npm run build
